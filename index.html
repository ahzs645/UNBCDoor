<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UNBC Door Sign Generator</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/styles.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;900&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr 1fr; /* Two columns for form and preview */
            gap: 30px;
            align-items: start; /* Align items to the top */
        }

        .controls {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
        }

        .label {
            font-style: italic;
            font-weight: 500;
        }

        .contact-info {
            font-style: italic;
            line-height: 1.2;
        }

        .contact-info div {
            margin-bottom: 4px;
        }

        .label {
            font-style: italic;
            font-weight: 500;
            margin-right: 4px;
        }

        .designation-option {
            display: flex;
            align-items: center;
            padding: 8px 12px;
            border-radius: 4px;
            transition: all 0.2s ease;
            cursor: pointer;
            position: relative;
            margin: 2px 0;
        }

        .toggle-button {
            padding: 10px 20px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-block;
        }

        .toggle-button.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .toggle-button:hover {
            background: #f7fafc;
        }

        .toggle-button i {
            margin-right: 8px;
        }

        .toggle-buttons-container {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .designation-option:hover {
            background-color: rgba(0, 0, 0, 0.05);
        }

        .designation-option input[type="checkbox"] {
            margin-right: 8px;
            position: relative;
            z-index: 2;
        }

        .designation-option label {
            cursor: pointer;
            user-select: none;
            transition: color 0.2s ease;
            position: relative;
            z-index: 2;
            flex: 1;
        }

        .designation-option input[type="checkbox"]:checked + label {
            color: #666;
            font-weight: 500;
        }

        .designation-option input[type="checkbox"]:checked ~ .designation-option {
            background-color: transparent;
        }

        .designation-option input[type="checkbox"]:checked + label::before {
            content: '';
            position: absolute;
            top: -8px;
            left: -12px;
            right: -12px;
            bottom: -8px;
            background-color: rgba(0, 0, 0, 0.1);
            border-radius: 4px;
            z-index: -1;
        }

        .designation-options {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 10px;
            margin-bottom: 15px;
        }

        .custom-designation {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .selected-designations {
            font-size: 0.9em;
            color: #4a5568;
        }

        .sign-header {
            background: #035b42;
            color: white;
            padding: 15px 20px;
            height: 80px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .unbc-logo {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0px;
        }
        
        .unbc-logo svg {
            display: block;
            width: 200px;
            flex-shrink: 0;
            margin-bottom: -10px;
        }
        
        .alumni-badge {
            display: none;
            flex-shrink: 0;
            height: fit-content;
            margin-left: 20px;
            align-self: center;
        }
        
        .alumni-badge svg {
            width: 80px;
            height: auto;
        }

        .sign-content {
            display: flex;
            align-items: center;
            padding: 20px;
            background: white;
            min-height: 200px;
        }

        .main-content {
            flex: 1;
            font-family: 'Inter', sans-serif;
        }

        .main-content .name {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 8px;
            color: #333;
        }

        .main-content .position {
            font-size: 18px;
            font-weight: 500;
            margin-bottom: 12px;
            color: #666;
        }

        .main-content .room-name {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 12px;
            color: #333;
        }

        .main-content .department {
            font-size: 16px;
            font-weight: 500;
            margin-bottom: 12px;
            color: #666;
        }

        .main-content .contact-info {
            font-size: 14px;
            color: #666;
            margin-top: 12px;
        }

        .main-content .designations {
            font-size: 14px;
            font-weight: 500;
            color: #666;
            margin-top: 8px;
        }

        .preview {
            /* Removed sticky, container is now sticky */
            background: white;
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }

        .door-sign {
            width: 500px;
            height: 300px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            overflow: hidden;
            position: relative;
            margin: 0 auto;
        }

        /* Remove conflicting style from media query if it exists and causes issues */
        @media (max-width: 1200px) {
            .door-sign {
                transform: scale(0.8); /* Keep or adjust as needed for responsiveness */
                transform-origin: center;
            }
        }

        /* Add styles for card holder info */
        .card-holder-info {
            background: #f8fafc;
            padding: 8px 12px;
            border-radius: 4px;
            border: 1px solid #e2e8f0;
        }

        .card-holder-info p {
            margin: 4px 0;
        }

        .card-holder-info strong {
            color: #4a5568;
        }

        /* Add styles for search results */
        .search-input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 14px;
            margin-bottom: 10px;
        }

        .search-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .search-results {
            max-height: 200px;
            overflow-y: auto;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            margin-top: 5px;
            display: none; /* Hidden by default */
            background-color: white; /* Ensure results are readable */
            position: absolute; /* Position over other content */
            width: calc(100% - 60px); /* Match form width minus padding */
            z-index: 10; /* Ensure it appears above other elements */
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .search-result-item {
            padding: 8px 12px;
            cursor: pointer;
            border-bottom: 1px solid #e2e8f0;
        }

        .search-result-item:hover {
            background-color: #f7fafc;
        }

        .search-result-item:last-child {
            border-bottom: none;
        }

        .card-holder-selector-container {
            background: white;
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            position: sticky;
            top: 20px;
        }

        .preview {
            margin-top: 20px;
            display: flex;
            justify-content: center;
        }

        .door-sign {
            width: 500px;
            height: 300px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            overflow: hidden;
            position: relative;
        }

        #designationsContainer {
            margin-top: 10px;
            padding: 15px;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            background: #f8fafc;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="controls">
            <h1>UNBC Door Sign Generator</h1>
            <form id="signForm">
                <div class="form-group">
                    <label for="signType">Sign Type</label>
                    <select id="signType" name="signType">
                        <option value="faculty">Faculty</option>
                        <option value="staff">Staff</option>
                        <option value="student">Student</option>
                        <option value="lab">Lab</option>
                        <option value="general-room">General Room</option>
                        <option value="custodian-closet">Custodian Closet</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="departmentSearch">Search Departments</label>
                    <input type="text" id="departmentSearch" placeholder="Search departments..." class="search-input">
                </div>

                <div class="form-group" style="display: none;">
                    <label for="departmentType">Department Type</label>
                    <select id="departmentType" name="departmentType">
                        <option value="">Select Department Type</option>
                        <option value="academic">🎓 Academic Departments</option>
                        <option value="administrative">🌐 Administrative Departments</option>
                    </select>
                </div>

                <div class="form-group" style="display: none;">
                    <label for="mainDepartment">Department</label>
                    <select id="mainDepartment" name="mainDepartment">
                        <option value="">Select Department</option>
                    </select>
                </div>

                <div class="form-group" style="display: none;">
                    <label for="subDepartment">Sub-Department</label>
                    <select id="subDepartment" name="subDepartment">
                        <option value="">Select Sub-Department</option>
                    </select>
                </div>

                <div class="form-group" style="display: none;">
                    <label for="subSubDepartment">Unit</label>
                    <select id="subSubDepartment" name="subSubDepartment">
                        <option value="">Select Unit</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="name">Name</label>
                    <input type="text" id="name" name="name" placeholder="Enter Name">
                </div>

                <div class="form-group">
                    <label for="position">Position</label>
                    <input type="text" id="position" name="position" placeholder="Enter Position">
                </div>

                <div class="form-group">
                    <label for="email">Email</label>
                    <input type="email" id="email" name="email" placeholder="enter.email@unbc.ca">
                </div>

                <div class="form-group">
                    <label for="phone">Phone</label>
                    <input type="tel" id="phone" name="phone" placeholder="250-960-XXXX" pattern="[0-9]{3}-[0-9]{3}-[0-9]{4}">
                </div>

                <div class="form-group">
                    <label for="roomName">Room Name</label>
                    <input type="text" id="roomName" name="roomName" placeholder="Enter room name">
                </div>

                <div class="form-group toggle-buttons-container">
                    <button type="button" id="alumniToggle" class="toggle-button">
                        <i>🎓</i>
                        Show Alumni Badge
                    </button>
                    <button type="button" id="designationsToggle" class="toggle-button">
                        <i>📜</i>
                        Enable Designations
                    </button>
                </div>

                <button type="button" id="exportBtn" class="export-btn">Export Sign</button>
            </form>
        </div>

        <!-- Container for card holder selection and preview -->
        <div class="card-holder-selector-container">
            <div class="form-group">
                <label for="cardHolderType">Card Holder Type</label>
                <select id="cardHolderType" name="cardHolderType">
                    <option value="">Select Card Holder Type</option>
                </select>
                <div id="cardHolderInfo" class="card-holder-info" style="display: none; margin-top: 8px; font-size: 0.9em; color: #666;"></div>
            </div>

            <div id="designationsContainer" class="form-group" style="display: none;">
                <div class="designation-options">
                    <!-- Designations will be populated here -->
                </div>
                <div class="custom-designation">
                    <input type="text" id="customDesignation" placeholder="Enter custom designation">
                    <button type="button" id="addCustomDesignation">Add</button>
                </div>
                <div id="selectedDesignations" class="selected-designations"></div>
            </div>

            <div class="preview">
                <div class="door-sign">
                    <div class="sign-header">
                        <div class="unbc-logo">
                            <svg id="Layer_2" data-name="Layer 2" xmlns="http://www.w3.org/2000/svg" width="178" height="80" viewBox="0 0 178 80">
                                <g id="Layer_1-2" data-name="Layer 1">
                                    <g id="logoAndTextGroup" transform="translate(0, 15)">
                                        <text transform="translate(57.73 36.56)" fill="#fff" font-family="HelveticaNeue-Black, 'Helvetica Neue'" font-size="8.23" font-weight="800" id="svgDepartmentText" xml:space="preserve"><tspan x="0" y="0"></tspan></text>
                                        <g>
                                            <g>
                                                <polygon points="17.3 6.57 12.41 30.68 16.66 30.68 19.93 14.87 22.34 23.75 26.4 23.75 31.22 0 27.13 0 24.14 14.98 21.39 6.57 17.3 6.57" fill="#fff"/>
                                                <path d="M33.14,17.24l.41-2.01h1.83c1.14,0,1.98.57,1.89,2.04-.12,1.97-1.62,2.7-2.3,2.69h-2.39l.56-2.72-3.98-1.24-1.59,7.75h7.79c2.43,0,5.84-2.22,6.09-6.1.2-3.15-.73-4.02-2.1-5.03.98-.93,1.24-1.59,1.21-3.06-.04-1.74-1.25-2.96-2.59-3h-6.88l-.68,3.3,4.05.81.27-1.31h.97c.67.08.97.55.92,1.13-.1,1.1-.88,1.7-1.56,1.71h-.9l.31-1.53-4.05-.81-1.26,6.14,3.98,1.24Z" fill="#fff"/>
                                                <path d="M6.81,20.09c-1.01,0-2.4-.25-2.21-1.31l2.61-12.26H2.89S.53,17.64.06,19.84c-.47,2.2,1.65,4.35,5.84,4.35s6.91-2.07,7.41-4.44c.5-2.37,2.81-13.23,2.81-13.23h-4.35l-2.6,12.22c-.24.93-1.34,1.35-2.36,1.35" fill="#fff" fill-rule="evenodd"/>
                                                <path d="M54.97,6.3c-3.69-.47-11.12,1.16-12.75,8.84-1.63,7.68,5.29,9.62,9.03,9.06l1.08-5.09c-3.62.82-6.22-.35-5.44-4.01.77-3.62,4.08-5,7.08-4.31l1-4.48" fill="#fff" fill-rule="evenodd"/>
                                                <path d="M63.66,8.1l-.78,3.66c-.25,1.16-1.18,2.13-2.72,2.13s-1.96-.97-1.74-2.03l.8-3.76h.76l-.76,3.55c-.26,1.23.41,1.56,1.1,1.56s1.55-.32,1.81-1.55l.76-3.57h.76Z" fill="#fff"/>
                                                <path d="M68.61,8.1h.74l-1.2,5.64h-.86l-1.9-4.56h-.02l-.97,4.56h-.74l1.2-5.64h.9l1.85,4.56h.02l.97-4.56Z" fill="#fff"/>
                                                <path d="M70.22,13.74h-.76l1.2-5.64h.76l-1.2,5.64Z" fill="#fff"/>
                                                <path d="M76.35,8.1h.86l-3.26,5.64h-.81l-.86-5.64h.85l.59,4.81h.02l2.62-4.81Z" fill="#fff"/>
                                                <path d="M81.01,13.74h-4.17l1.2-5.64h4.11l-.14.68h-3.35l-.37,1.73h3.09l-.14.68h-3.09l-.4,1.89h3.4l-.14.68Z" fill="#fff"/>
                                                <path d="M83.93,8.75h1.9c.38,0,1,.07.81.94-.18.83-.8.97-1.35.97h-1.77l.41-1.92ZM83.38,11.32h1.85c.91,0,.89.54.79,1.01-.05.21-.2,1.07-.17,1.41h.93l.03-.13c-.21-.13-.22-.25-.16-.57l.17-1.02c.14-.79-.16-.93-.45-1.06.41-.21.9-.52,1.07-1.35.25-1.19-.6-1.52-1.53-1.52h-2.61l-1.2,5.64h.76l.51-2.42Z" fill="#fff"/>
                                                <path d="M91.93,9.75c.15-.87-.52-1.15-1.16-1.15-.48,0-1.32.13-1.5.99-.1.48.2.64.52.72l1.53.37c.69.17,1.15.61.96,1.51-.28,1.34-1.6,1.71-2.57,1.71-1.05,0-1.39-.31-1.59-.54-.39-.43-.38-.9-.27-1.43h.72c-.22,1.02.55,1.32,1.28,1.32.55,0,1.51-.14,1.68-.95.13-.59-.11-.78-.99-1l-1.1-.27c-.35-.09-1.13-.35-.92-1.33.19-.88.94-1.74,2.31-1.74,1.97,0,1.92,1.18,1.82,1.8h-.72Z" fill="#fff"/>
                                                <path d="M93.8,13.74h-.76l1.2-5.64h.76l-1.2,5.64Z" fill="#fff"/>
                                                <path d="M95.82,8.1h4.58l-.14.68h-1.91l-1.06,4.97h-.76l1.06-4.97h-1.91l.14-.68Z" fill="#fff"/>
                                                <path d="M102.31,13.74h-.76l.48-2.27-1.41-3.37h.89l1.04,2.71,2.2-2.71h.9l-2.85,3.37-.48,2.27Z" fill="#fff"/>
                                                <path d="M112.36,10.92c-.28,1.33-1.23,2.29-2.45,2.29s-1.76-.97-1.48-2.29c.28-1.33,1.23-2.29,2.45-2.29s1.76.97,1.48,2.29ZM113.15,10.92c.26-1.22-.01-2.97-2.12-2.97s-3.12,1.75-3.38,2.97c-.26,1.22.01,2.97,2.12,2.97s3.12-1.75,3.38-2.97Z" fill="#fff"/>
                                                <path d="M114.29,13.74h-.76l1.2-5.64h3.91l-.14.68h-3.14l-.37,1.73h2.77l-.14.68h-2.77l-.54,2.56Z" fill="#fff"/>
                                                <path d="M62.93,17.59h.74l-1.2,5.64h-.86l-1.9-4.56h-.02l-.97,4.56h-.74l1.2-5.64h.9l1.85,4.56h.02l.97-4.56Z" fill="#fff"/>
                                                <path d="M68.69,20.42c-.28,1.33-1.23,2.29-2.45,2.29s-1.76-.97-1.48-2.29c.28-1.33,1.23-2.29,2.45-2.29s1.76.97,1.48,2.29ZM69.48,20.42c.26-1.22-.01-2.97-2.12-2.97s-3.12,1.75-3.38,2.97c-.26,1.22.01,2.97,2.12,2.97s3.12-1.75,3.38-2.97Z" fill="#fff"/>
                                                <path d="M71.7,18.25h1.9c.38,0,1,.07.81.94-.18.83-.8.97-1.35.97h-1.77l.41-1.92ZM71.15,20.82h1.85c.91,0,.89.54.79,1.01-.04.21-.2,1.07-.17,1.41h.94l.03-.13c-.21-.13-.22-.25-.16-.57l.17-1.02c.14-.79-.16-.93-.45-1.06.41-.21.9-.52,1.07-1.35.25-1.19-.6-1.52-1.53-1.52h-2.61l-1.2,5.64h.76l.51-2.42Z" fill="#fff"/>
                                                <path d="M75.93,17.59h4.58l-.14.68h-1.91l-1.06,4.97h-.76l1.06-4.97h-1.91l.14-.68Z" fill="#fff"/>
                                                <path d="M84.94,17.59h.76l-1.2,5.64h-.76l.56-2.63h-2.95l-.56,2.63h-.76l1.2-5.64h.76l-.5,2.33h2.95l.5-2.33Z" fill="#fff"/>
                                                <path d="M89.94,23.24h-4.16l1.2-5.64h4.11l-.14.68h-3.35l-.37,1.73h3.09l-.14.68h-3.09l-.4,1.89h3.4l-.14.68Z" fill="#fff"/>
                                                <path d="M92.85,18.25h1.9c.38,0,1,.07.81.94-.18.83-.8.97-1.35.97h-1.77l.41-1.92ZM92.31,20.82h1.85c.91,0,.89.54.79,1.01-.04.21-.2,1.07-.17,1.41h.94l.03-.13c-.21-.13-.22-.25-.16-.57l.17-1.02c.14-.79-.16-.93-.45-1.06.41-.21.9-.52,1.07-1.35.25-1.19-.6-1.52-1.53-1.52h-2.61l-1.2,5.64h.76l.51-2.42Z" fill="#fff"/>
                                                <path d="M101.55,17.59h.74l-1.2,5.64h-.86l-1.9-4.56h-.02l-.97,4.56h-.74l1.2-5.64h.9l1.85,4.56h.02l.97-4.56Z" fill="#fff"/>
                                                <path d="M106.28,18.25h1.38c.85,0,1.11.3,1,.82-.15.69-.64.91-1.37.91h-1.38l.37-1.74ZM104.45,23.24h2.43c1.25,0,2.08-.76,2.27-1.67.21-.97-.39-1.23-.73-1.37.68-.29.93-.81,1-1.18.16-.77-.24-1.42-1.29-1.42h-2.48l-1.2,5.64ZM105.78,20.6h1.5c.62,0,1.29.16,1.12.95-.13.63-.62,1.03-1.41,1.03h-1.63l.42-1.98Z" fill="#fff"/>
                                                <path d="M111.63,18.25h1.9c.38,0,1,.07.81.94-.18.83-.8.97-1.35.97h-1.77l.41-1.92ZM111.08,20.82h1.85c.91,0,.89.54.79,1.01-.05.21-.2,1.07-.17,1.41h.94l.03-.13c-.21-.13-.22-.25-.16-.57l.17-1.02c.14-.79-.16-.93-.45-1.06.41-.21.9-.52,1.07-1.35.25-1.19-.6-1.52-1.53-1.52h-2.61l-1.2,5.64h.76l.51-2.42Z" fill="#fff"/>
                                                <path d="M116.26,23.24h-.76l1.2-5.64h.76l-1.2,5.64Z" fill="#fff"/>
                                                <path d="M118.28,17.59h4.58l-.14.68h-1.91l-1.06,4.97h-.76l1.06-4.97h-1.91l.14-.68Z" fill="#fff"/>
                                                <path d="M123.25,23.24h-.76l1.2-5.64h.76l-1.2,5.64Z" fill="#fff"/>
                                                <path d="M128.81,19.24c.15-.87-.52-1.15-1.15-1.15-.48,0-1.32.13-1.5.99-.1.48.2.64.52.72l1.53.37c.69.17,1.15.61.96,1.51-.28,1.34-1.6,1.71-2.57,1.71-1.05,0-1.39-.31-1.59-.54-.39-.43-.38-.9-.27-1.43h.72c-.22,1.02.55,1.32,1.28,1.32.55,0,1.51-.14,1.68-.95.13-.59-.11-.78-.99-1l-1.1-.27c-.35-.09-1.13-.35-.92-1.33.19-.88.94-1.74,2.31-1.74,1.97,0,1.92,1.18,1.82,1.8h-.72Z" fill="#fff"/>
                                                <path d="M134.71,17.59h.76l-1.2,5.64h-.76l.56-2.63h-2.95l-.56,2.63h-.76l1.2-5.64h.76l-.5,2.33h2.95l.5-2.33Z" fill="#fff"/>
                                                <path d="M142.45,19.29c0-.99-.79-1.17-1.33-1.17-1.02,0-2.01.75-2.32,2.24-.28,1.33-.03,2.35,1.37,2.35.5,0,1.4-.24,1.94-1.55h.74c-.77,2.13-2.52,2.22-2.94,2.22-1.28,0-2.36-.83-1.9-3,.37-1.74,1.61-2.94,3.26-2.94,1.45,0,2.02.9,1.93,1.85h-.74Z" fill="#fff"/>
                                                <path d="M148.35,20.42c-.28,1.33-1.23,2.29-2.45,2.29s-1.76-.97-1.48-2.29c.28-1.33,1.23-2.29,2.45-2.29s1.76.97,1.48,2.29ZM149.14,20.42c.26-1.22-.01-2.97-2.12-2.97s-3.12,1.75-3.38,2.97c-.26,1.22.01,2.97,2.12,2.97s3.12-1.75,3.38-2.97Z" fill="#fff"/>
                                                <path d="M150.35,22.56h2.86l-.14.68h-3.62l1.2-5.64h.76l-1.06,4.97Z" fill="#fff"/>
                                                <path d="M159.48,17.59l-.78,3.66c-.25,1.16-1.18,2.13-2.72,2.13s-1.96-.97-1.74-2.03l.8-3.76h.76l-.76,3.55c-.26,1.23.41,1.56,1.1,1.56s1.55-.32,1.81-1.55l.76-3.57h.76Z" fill="#fff"/>
                                                <path d="M164.13,23.24l.71-3.33c.03-.17.2-.88.31-1.41h-.02l-2.59,4.74h-.75l-.58-4.73h-.02c-.11.52-.25,1.23-.28,1.4l-.71,3.33h-.74l1.2-5.64h1.09l.6,4.77h.02l2.62-4.77h1.08l-1.2,5.64h-.74Z" fill="#fff"/>
                                                <path d="M167.84,18.25h1.38c.85,0,1.11.3,1,.82-.15.69-.64.91-1.37.91h-1.38l.37-1.74ZM166.02,23.24h2.43c1.25,0,2.08-.76,2.27-1.67.21-.97-.39-1.23-.73-1.37.68-.29.93-.81,1-1.18.16-.77-.24-1.42-1.29-1.42h-2.48l-1.2,5.64ZM167.34,20.6h1.5c.62,0,1.29.16,1.12.95-.13.63-.62,1.03-1.41,1.03h-1.63l.42-1.98Z" fill="#fff"/>
                                                <path d="M172.15,23.24h-.76l1.2-5.64h.76l-1.2,5.64Z" fill="#fff"/>
                                                <path d="M175.08,20.92l1.43-2.48h.02l.3,2.48h-1.75ZM176.96,21.59l.21,1.64h.83l-.84-5.64h-.86l-3.32,5.64h.79l.94-1.64h2.26Z" fill="#fff"/>
                                            </g>
                                        </g>
                                    </g>
                                </g>
                            </svg>
                        </div>
                    </div>
                    <div class="sign-content">
                        <div class="main-content">
                            <div class="name-title"></div>
                            <div class="department-info"></div>
                            <div class="contact-info"></div>
                            <div class="designations-display"></div>
                        </div>
                        <div class="alumni-badge">
                            <img src="components/alumni-badge.svg" alt="UNBC Alumni Badge" width="80" height="auto">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <script src="js/departments.js"></script>
    <script src="js/cardHolders.js"></script>
    <script>
        // DOM Elements
        const signForm = document.getElementById('signForm');
        const signType = document.getElementById('signType');
        const departmentType = document.getElementById('departmentType');
        const departmentSearch = document.getElementById('departmentSearch');
        const mainDepartment = document.getElementById('mainDepartment');
        const subDepartment = document.getElementById('subDepartment');
        const subSubDepartment = document.getElementById('subSubDepartment');
        const nameInput = document.getElementById('name');
        const positionInput = document.getElementById('position');
        const emailInput = document.getElementById('email');
        const phoneInput = document.getElementById('phone');
        const roomNameInput = document.getElementById('roomName');
        const alumniToggle = document.getElementById('alumniToggle');
        const designationsToggle = document.getElementById('designationsToggle');
        const designationsContainer = document.getElementById('designationsContainer');
        const exportBtn = document.getElementById('exportBtn');
        const signContent = document.querySelector('.sign-content .main-content');
        const alumniBadge = document.querySelector('.alumni-badge');
        const doorSign = document.querySelector('.door-sign');
        const cardHolderTypeSelect = document.getElementById('cardHolderType');
        const cardHolderInfoDiv = document.getElementById('cardHolderInfo');

        // Designation list
        const designationList = [
            "PhD", "MD", "JD", "MBA", "MSc", "MA", "BSc", "BA", "BEng", "BBA",
            "PEng", "PGeo", "P.Ag", "RPF", "RPP", "MCIP", "CPA", "CA", "CMA", "CGA"
        ];

        // Format phone number
        function formatPhoneNumber(input) {
            let value = input.value.replace(/\D/g, '');
            if (value.length > 0) {
                if (value.length <= 3) {
                    input.value = value;
                } else if (value.length <= 6) {
                    input.value = value.slice(0, 3) + '-' + value.slice(3);
                } else {
                    input.value = value.slice(0, 3) + '-' + value.slice(3, 6) + '-' + value.slice(6, 10);
                }
            }
        }

        // Update selected designations display
        function updateSelectedDesignations() {
            const selectedDesignations = document.getElementById('selectedDesignations');
            const checkedDesignations = Array.from(document.querySelectorAll('input[name="designations"]:checked'))
                .map(checkbox => checkbox.value);
            
            selectedDesignations.innerHTML = checkedDesignations.length > 0 
                ? `<strong>Selected Designations:</strong> ${checkedDesignations.join(', ')}`
                : '';
            
            // Update the sign preview when designations change
            updateSign();
        }

        // Initialize designation options
        function initializeDesignationOptions() {
            const container = document.querySelector('.designation-options');
            if (!container) return;

            designationList.forEach(designation => {
                const label = document.createElement('label');
                label.className = 'designation-option';
                
                const checkbox = document.createElement('input');
                checkbox.type = 'checkbox';
                checkbox.name = 'designations';
                checkbox.value = designation;
                
                label.appendChild(checkbox);
                label.appendChild(document.createTextNode(designation));
                container.appendChild(label);
            });

            // Add event listeners for designation changes
            container.addEventListener('change', updateSelectedDesignations);
        }

        // Update SVG text
        function updateSVGText(department) {
            const svgDoc = document.querySelector('.unbc-logo svg');
            const logoContainer = document.querySelector('.unbc-logo');
            if (svgDoc) {
                const svgText = svgDoc.querySelector('#svgDepartmentText');
                if (svgText) {
                    // Clear existing tspans
                    svgText.innerHTML = '';
                    
                    // Get the full department path
                    const deptType = departmentType.value;
                    const mainDept = mainDepartment.value;
                    const subDept = subDepartment.value;
                    const subSubDept = subSubDepartment.value;

                    // Use the most specific department level available
                    let displayText = '';
                    if (subSubDept) {
                        displayText = subSubDept;
                    } else if (subDept) {
                        displayText = subDept;
                    } else if (mainDept) {
                        displayText = mainDept;
                    }
                    
                    if (displayText) {
                        // Split text into words
                        const words = displayText.split(' ');
                        let currentLine = '';
                        let lines = [];
                        
                        // Create lines with max 25 characters
                        words.forEach(word => {
                            if (currentLine.length + word.length + 1 <= 25) {
                                currentLine += (currentLine ? ' ' : '') + word;
                            } else {
                                lines.push(currentLine);
                                currentLine = word;
                            }
                        });
                        if (currentLine) {
                            lines.push(currentLine);
                        }
                        
                        // Create tspans for each line
                        lines.forEach((line, index) => {
                            const tspan = document.createElementNS('http://www.w3.org/2000/svg', 'tspan');
                            tspan.setAttribute('x', '0');
                            tspan.setAttribute('y', index * 10); // Adjust line spacing
                            tspan.textContent = line;
                            svgText.appendChild(tspan);
                        });

                        // Adjust logo position if there are 3 or more lines
                        if (lines.length >= 3) {
                            logoContainer.style.transform = 'translate(0px, -10px)';
                        } else {
                            logoContainer.style.transform = 'translate(0px, 0px)';
                        }
                    }
                }
            }
        }

        // Populate card holder types dropdown
        function populateCardHolderTypes() {
            cardHolderTypeSelect.innerHTML = '<option value="">Select Card Holder Type</option>';
            if (typeof cardHolders !== 'undefined') {
                Object.entries(cardHolders).forEach(([type, spec]) => {
                    const option = document.createElement('option');
                    option.value = type;
                    option.textContent = `${spec.name} (${spec.viewableArea.width}" × ${spec.viewableArea.height}")`;
                    cardHolderTypeSelect.appendChild(option);
                });
            }
        }

        // Update card holder info display
        function updateCardHolderInfo(type) {
            if (cardHolderInfoDiv) {
                if (type && cardHolders[type]) {
                    const spec = cardHolders[type];
                    cardHolderInfoDiv.innerHTML = `
                        <p><strong>Description:</strong> ${spec.description}</p>
                        <p><strong>Viewable Area:</strong> ${spec.viewableArea.width}" × ${spec.viewableArea.height}"</p>
                        <p><strong>Total Area:</strong> ${spec.totalArea.width}" × ${spec.totalArea.height}"</p>
                        <p><strong>Border Width:</strong> ${spec.borderWidth}"</p>
                    `;
                    cardHolderInfoDiv.style.display = 'block';
                } else {
                    cardHolderInfoDiv.style.display = 'none';
                }
            }
        }

        // Update door sign scaling based on card holder type
        function updateDoorSignDimensions(type) {
            const baseWidthPx = 500;
            const baseHeightPx = 300;

            if (doorSign) {
                if (type && cardHolders[type]) {
                    const spec = cardHolders[type];
                    const viewableWidthIn = spec.viewableArea.width;
                    const viewableHeightIn = spec.viewableArea.height;

                    const targetWidthPx = viewableWidthIn * 96;
                    const targetHeightPx = viewableHeightIn * 96;

                    const scaleX = targetWidthPx / baseWidthPx;
                    const scaleY = targetHeightPx / baseHeightPx;
                    const scaleFactor = Math.min(scaleX, scaleY);

                    doorSign.style.transform = `scale(${scaleFactor})`;
                    doorSign.style.transformOrigin = 'center';

                } else {
                    doorSign.style.transform = 'none';
                    doorSign.style.transformOrigin = '';
                }
            }
        }

        // Event listener for card holder type change
        if (cardHolderTypeSelect) {
            cardHolderTypeSelect.addEventListener('change', (e) => {
                const type = e.target.value;
                updateCardHolderInfo(type);
                updateDoorSignDimensions(type);
                updateSign();
            });
        }

        // Search functionality
        function searchDepartments(query) {
            query = query.toLowerCase();
            const results = [];

            if (typeof departmentTypes !== 'undefined') {
                Object.entries(departmentTypes).forEach(([type, typeData]) => {
                    if (typeData.departments && typeof typeData.departments === 'object') {
                        Object.entries(typeData.departments).forEach(([mainDept, subDepts]) => {
                            if (mainDept.toLowerCase().includes(query)) {
                                results.push({
                                    type,
                                    mainDept,
                                    path: `${typeData.name} > ${mainDept}`
                                });
                            }

                            if (typeof subDepts === 'object' && !Array.isArray(subDepts)) {
                                Object.entries(subDepts).forEach(([subDept, subSubDepts]) => {
                                    if (subDept.toLowerCase().includes(query)) {
                                        results.push({
                                            type,
                                            mainDept,
                                            subDept,
                                            path: `${typeData.name} > ${mainDept} > ${subDept}`
                                        });
                                    }

                                    if (typeof subSubDepts === 'object' && !Array.isArray(subSubDepts)) {
                                        Object.entries(subSubDepts).forEach(([subSubDept, _]) => {
                                            if (subSubDept.toLowerCase().includes(query)) {
                                                results.push({
                                                    type,
                                                    mainDept,
                                                    subDept,
                                                    subSubDept,
                                                    path: `${typeData.name} > ${mainDept} > ${subDept} > ${subSubDept}`
                                                });
                                            }
                                        });
                                    }
                                });
                            }
                        });
                    }
                });
            }

            return results;
        }

        // Create and show search results
        function showSearchResults(query) {
            const existingResults = document.querySelector('.search-results');
            if (existingResults) {
                existingResults.remove();
            }

            const results = searchDepartments(query);
            const resultsContainer = document.createElement('div');
            resultsContainer.className = 'search-results';

            if (results.length > 0) {
                results.forEach(result => {
                    const div = document.createElement('div');
                    div.className = 'search-result-item';
                    div.textContent = result.path;
                    div.addEventListener('click', () => {
                        if (departmentType) departmentType.value = result.type;
                        populateMainDepartments();
                        setTimeout(() => {
                             if (mainDepartment) mainDepartment.value = result.mainDept;
                            populateSubDepartments(result.mainDept);
                            setTimeout(() => {
                                if (result.subDept) {
                                    if (subDepartment) subDepartment.value = result.subDept;
                                    populateSubSubDepartments(result.mainDept, result.subDept);
                                    setTimeout(() => {
                                        if (result.subSubDept) {
                                            if (subSubDepartment) subSubDepartment.value = result.subSubDept;
                                        }
                                        updateSign();
                                    }, 0);
                                } else {
                                     updateSign();
                                }
                            }, 0);
                        }, 0);

                        resultsContainer.style.display = 'none';
                    });
                    resultsContainer.appendChild(div);
                });
                resultsContainer.style.display = 'block';
            } else {
                 resultsContainer.style.display = 'none';
            }

            if (departmentSearch && departmentSearch.parentNode) {
                departmentSearch.parentNode.appendChild(resultsContainer);
            }
        }

        // Event listener for search input
        if (departmentSearch) {
            departmentSearch.addEventListener('input', (e) => {
                const query = e.target.value.trim();
                if (query.length > 0) {
                    showSearchResults(query);
                } else {
                    const resultsContainer = document.querySelector('.search-results');
                    if (resultsContainer) {
                        resultsContainer.style.display = 'none';
                    }
                     departmentType.value = '';
                    populateMainDepartments();
                    updateSign();
                }
            });
        }

        // Close search results when clicking outside
        document.addEventListener('click', (e) => {
            if (!e.target.closest('.search-input') && !e.target.closest('.search-results')) {
                const resultsContainer = document.querySelector('.search-results');
                if (resultsContainer) {
                    resultsContainer.style.display = 'none';
                }
            }
        });

        // Populate main departments based on department type
        function populateMainDepartments() {
            mainDepartment.innerHTML = '<option value="">Select Department</option>';
            subDepartment.innerHTML = '<option value="">Select Sub-Department</option>';
            subSubDepartment.innerHTML = '<option value="">Select Unit</option>';

            const selectedType = departmentType.value;
            if (selectedType && departmentTypes[selectedType]) {
                const departments = departmentTypes[selectedType].departments;
                if (departments && typeof departments === 'object') {
                     Object.keys(departments).forEach(dept => {
                        const option = document.createElement('option');
                        option.value = dept;
                        option.textContent = dept;
                        if (mainDepartment) mainDepartment.appendChild(option);
                    });
                }
                if (mainDepartment && mainDepartment.parentElement) mainDepartment.parentElement.style.display = 'block';
            } else {
                if (mainDepartment && mainDepartment.parentElement) mainDepartment.parentElement.style.display = 'none';
                if (subDepartment && subDepartment.parentElement) subDepartment.parentElement.style.display = 'none';
                if (subSubDepartment && subSubDepartment.parentElement) subSubDepartment.parentElement.style.display = 'none';
            }
        }

        // Populate sub-departments
        function populateSubDepartments(mainDept) {
            subDepartment.innerHTML = '<option value="">Select Sub-Department</option>';
            subSubDepartment.innerHTML = '<option value="">Select Unit</option>';
            const selectedType = departmentType.value;

            if (selectedType && mainDept && departmentTypes[selectedType].departments && departmentTypes[selectedType].departments[mainDept]) {
                const subDepts = departmentTypes[selectedType].departments[mainDept];
                if (typeof subDepts === 'object' && !Array.isArray(subDepts)) {
                    Object.keys(subDepts).forEach(subDept => {
                        const option = document.createElement('option');
                        option.value = subDept;
                        option.textContent = subDept;
                        if (subDepartment) subDepartment.appendChild(option);
                    });
                    if (subDepartment && subDepartment.parentElement) subDepartment.parentElement.style.display = 'block';
                } else {
                     if (subDepartment && subDepartment.parentElement) subDepartment.parentElement.style.display = 'none';
                }
            } else {
                if (subDepartment && subDepartment.parentElement) subDepartment.parentElement.style.display = 'none';
                if (subSubDepartment && subSubDepartment.parentElement) subSubDepartment.parentElement.style.display = 'none';
            }
        }

        // Populate sub-sub-departments
        function populateSubSubDepartments(mainDept, subDept) {
            subSubDepartment.innerHTML = '<option value="">Select Unit</option>';
            const selectedType = departmentType.value;

            if (selectedType && mainDept && departmentTypes[selectedType].departments && 
                departmentTypes[selectedType].departments[mainDept] && 
                departmentTypes[selectedType].departments[mainDept][subDept]) {
                
                const subSubDepts = departmentTypes[selectedType].departments[mainDept][subDept];
                
                if (Array.isArray(subSubDepts)) {
                    subSubDepts.forEach(unit => {
                        const option = document.createElement('option');
                        option.value = unit;
                        option.textContent = unit;
                        if (subSubDepartment) subSubDepartment.appendChild(option);
                    });
                } else if (typeof subSubDepts === 'object') {
                    Object.entries(subSubDepts).forEach(([unitName, unitArray]) => {
                        if (Array.isArray(unitArray)) {
                            const option = document.createElement('option');
                            option.value = unitName; // Use the full name as the value
                            option.textContent = unitName; // Use the full name as the display text
                            if (subSubDepartment) subSubDepartment.appendChild(option);
                        }
                    });
                }
                
                if (subSubDepartment && subSubDepartment.parentElement) {
                    subSubDepartment.parentElement.style.display = 'block';
                }
            } else {
                if (subSubDepartment && subSubDepartment.parentElement) {
                    subSubDepartment.parentElement.style.display = 'none';
                }
            }
        }

        // Event Listeners for progressive display
        if (departmentType) {
            departmentType.addEventListener('change', () => {
                populateMainDepartments();
                updateSign();
            });
        }

        if (mainDepartment) {
            mainDepartment.addEventListener('change', () => {
                populateSubDepartments(mainDepartment.value);
                updateSign();
            });
        }

        if (subDepartment) {
            subDepartment.addEventListener('change', () => {
                populateSubSubDepartments(mainDepartment.value, subDepartment.value);
                updateSign();
            });
        }

        if (subSubDepartment) {
            subSubDepartment.addEventListener('change', updateSign);
        }

        // Event Listeners for other form elements
        if (signType) {
            signType.addEventListener('change', () => {
                const type = signType.value;
                console.log('Sign type changed to:', type); // Debug log

                // Show/hide form elements based on sign type
                const formElements = {
                    name: type === 'faculty' || type === 'staff' || type === 'student' || type === 'lab',
                    position: type === 'faculty' || type === 'staff',
                    email: type === 'faculty' || type === 'staff' || type === 'student',
                    phone: type === 'faculty' || type === 'staff',
                    roomName: type === 'lab' || type === 'general-room' || type === 'custodian-closet',
                    alumniToggle: type === 'faculty' || type === 'staff',
                    designationsToggle: type === 'faculty' || type === 'staff'
                };

                // Update visibility of form elements
                Object.entries(formElements).forEach(([elementId, shouldShow]) => {
                    const element = document.getElementById(elementId);
                    if (element && element.parentElement) {
                        element.parentElement.style.display = shouldShow ? 'block' : 'none';
                    }
                });

                // Update designations container visibility
                if (designationsContainer) {
                    designationsContainer.style.display = 
                        (type === 'faculty' || type === 'staff') && 
                        designationsToggle.classList.contains('active') ? 'block' : 'none';
                }

                updateSign();
            });
        }

        // Initialize form elements
        function initializeFormElements() {
            // Create form groups for inputs if they don't exist
            const formGroups = [
                { id: 'name', label: 'Name', type: 'text' },
                { id: 'position', label: 'Position', type: 'text' },
                { id: 'email', label: 'Email', type: 'email' },
                { id: 'phone', label: 'Phone', type: 'tel' },
                { id: 'roomName', label: 'Room Name', type: 'text' }
            ];

            formGroups.forEach(group => {
                if (!document.getElementById(group.id)) {
                    const formGroup = document.createElement('div');
                    formGroup.className = 'form-group';
                    
                    const label = document.createElement('label');
                    label.htmlFor = group.id;
                    label.textContent = group.label;
                    
                    const input = document.createElement('input');
                    input.type = group.type;
                    input.id = group.id;
                    input.name = group.id;
                    
                    formGroup.appendChild(label);
                    formGroup.appendChild(input);
                    signForm.insertBefore(formGroup, document.querySelector('.toggle-buttons-container'));
                }
            });

            // Add event listeners to inputs
            [nameInput, positionInput, emailInput, phoneInput, roomNameInput].forEach(input => {
                if (input) {
                    input.addEventListener('input', updateSign);
                }
            });

            // Show/hide form elements based on initial sign type
            if (signType) {
                signType.dispatchEvent(new Event('change'));
            }
        }

        if (alumniToggle) {
            alumniToggle.addEventListener('click', () => {
                alumniToggle.classList.toggle('active');
                updateSign();
            });
        }

        if (designationsToggle) {
            designationsToggle.addEventListener('click', () => {
                designationsToggle.classList.toggle('active');
                const container = document.getElementById('designationsContainer');
                if (container) {
                    container.style.display = designationsToggle.classList.contains('active') ? 'block' : 'none';
                }
            });
        }

        // Add event listener for custom designation
        const addCustomDesignation = document.getElementById('addCustomDesignation');
        const customDesignation = document.getElementById('customDesignation');
        if (addCustomDesignation && customDesignation) {
            addCustomDesignation.addEventListener('click', () => {
                const value = customDesignation.value.trim();
                if (value) {
                    const container = document.querySelector('.designation-options');
                    if (container) {
                        const label = document.createElement('label');
                        label.className = 'designation-option';
                        
                        const checkbox = document.createElement('input');
                        checkbox.type = 'checkbox';
                        checkbox.name = 'designations';
                        checkbox.value = value;
                        checkbox.checked = true;
                        
                        label.appendChild(checkbox);
                        label.appendChild(document.createTextNode(value));
                        container.appendChild(label);
                        
                        customDesignation.value = '';
                        updateSelectedDesignations();
                    }
                }
            });
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            initializeDesignationOptions();
            populateCardHolderTypes();
            initializeFormElements();

            // Show initial form elements
            if (signType && signType.parentElement) signType.parentElement.style.display = 'block';
            if (departmentSearch && departmentSearch.parentElement) departmentSearch.parentElement.style.display = 'block';
            if (departmentType && departmentType.parentElement) departmentType.parentElement.style.display = 'block';
            if (mainDepartment && mainDepartment.parentElement) mainDepartment.parentElement.style.display = 'none';
            if (subDepartment && subDepartment.parentElement) subDepartment.parentElement.style.display = 'none';
            if (subSubDepartment && subSubDepartment.parentElement) subSubDepartment.parentElement.style.display = 'none';

            // Move designations container to the card holder selector container
            const designationsContainer = document.getElementById('designationsContainer');
            const cardHolderSelectorContainer = document.querySelector('.card-holder-selector-container');
            if (designationsContainer && cardHolderSelectorContainer) {
                // Remove from current location if it exists
                designationsContainer.parentNode?.removeChild(designationsContainer);
                // Insert after the card holder info
                const cardHolderInfo = document.getElementById('cardHolderInfo');
                if (cardHolderInfo) {
                    cardHolderInfo.parentNode.insertBefore(designationsContainer, cardHolderInfo.nextSibling);
                } else {
                    cardHolderSelectorContainer.insertBefore(designationsContainer, cardHolderSelectorContainer.firstChild);
                }
            }

            // Trigger initial sign type change to set up form
            if (signType) {
                signType.dispatchEvent(new Event('change'));
            }

            updateSign();
        });

        // Update sign preview
        function updateSign() {
            const signContent = document.querySelector('.sign-content .main-content');
            if (!signContent) return;

            const type = signType.value;
            let content = '';

            // Add name and position for faculty/staff
            if (type === 'faculty' || type === 'staff') {
                const name = document.getElementById('name')?.value || '';
                const position = document.getElementById('position')?.value || '';
                if (name) content += `<div class="name">${name}</div>`;
                if (position) content += `<div class="position">${position}</div>`;
            }

            // Add room name for lab/general room/custodian closet
            if (type === 'lab' || type === 'general-room' || type === 'custodian-closet') {
                const roomName = document.getElementById('roomName')?.value || '';
                if (roomName) content += `<div class="room-name">${roomName}</div>`;
            }

            // Add contact info for faculty/staff/student
            if (type === 'faculty' || type === 'staff' || type === 'student') {
                const email = document.getElementById('email')?.value || '';
                const phone = document.getElementById('phone')?.value || '';
                if (email || phone) {
                    content += '<div class="contact-info">';
                    if (email) content += `<div>Email: ${email}</div>`;
                    if (phone) content += `<div>Phone: ${phone}</div>`;
                    content += '</div>';
                }
            }

            // Add designations
            if (type === 'faculty' || type === 'staff') {
                const checkedDesignations = Array.from(document.querySelectorAll('input[name="designations"]:checked'))
                    .map(checkbox => checkbox.value);
                if (checkedDesignations.length > 0) {
                    content += `<div class="designations">${checkedDesignations.join(', ')}</div>`;
                }
            }

            // Update the content
            signContent.innerHTML = content;

            // Update alumni badge visibility
            if (alumniBadge) {
                alumniBadge.style.display = (type === 'faculty' || type === 'staff') && 
                    alumniToggle.classList.contains('active') ? 'block' : 'none';
            }

            // Update SVG text with department info
            const deptType = departmentType.value;
            const mainDept = mainDepartment.value;
            const subDept = subDepartment.value;
            const subSubDept = subSubDepartment.value;

            // Use the most specific department level available for display
            let displayDept = '';
            if (subSubDept) {
                displayDept = subSubDept;
            } else if (subDept) {
                displayDept = subDept;
            } else if (mainDept) {
                displayDept = mainDept;
            }

            if (deptType && displayDept) {
                updateSVGText();
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            initializeDesignationOptions();
            populateMainDepartments();
            updateSign();
            // Move toggle buttons under the preview
            const toggleButtonsContainer = document.querySelector('.toggle-buttons-container');
            const preview = document.querySelector('.preview');
            if (toggleButtonsContainer && preview) {
                preview.parentNode.insertBefore(toggleButtonsContainer, preview.nextSibling);
            }
        });
    </script>
</body>
</html> 